#! /bin/sh

I2CSET="i2cset"
I2CBUS=1
I2CMUXADDR=0x71
I2CADDR0=0x74
I2CADDR1=0x73
I2C0="$I2CSET -y $I2CBUS $I2CADDR0"
I2C1="$I2CSET -y $I2CBUS $I2CADDR1"

H()
{
  printf "0x%02X" $(expr $1 + $2)
}

$I2CSET -y $I2CBUS $I2CMUXADDR 0xFF

$I2C0 0x00 0x30
$I2C0 0x01 0x04
$I2C0 0xFE 0x7C
$I2C0 0x00 0x20

for i in 6 10 14 18 22 26 30 34 38 42 46 50 54 58 62 66 ; do
  $I2C0 $(H $i 0) 0x00
  $I2C0 $(H $i 1) 0x00
  $I2C0 $(H $i 2) 0x32
  $I2C0 $(H $i 3) 0x01
done

$I2C1 0x00 0x30
$I2C1 0x01 0x04
$I2C1 0xFE 0x7C
$I2C1 0x00 0x20

for i in 6 10 14 18 22 26 30 34 38 42 46 50 54 58 62 66 ; do
  $I2C1 $(H $i 0) 0x00
  $I2C1 $(H $i 1) 0x00
  $I2C1 $(H $i 2) 0x32
  $I2C1 $(H $i 3) 0x01
done
